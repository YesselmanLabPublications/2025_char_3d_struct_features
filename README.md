# Code to for paper: "A quantitative framework for structural interpretation of DMS reactivity"

XXX link to bioRxiv preprint 

By D. H. Sanduni Deenalattha, Chris P. Jurich, Bret Lange, Darren Armstrong, Kaitlyn Nein, and Joseph D. Yesselman
Contact: jyesselm@unl.edu


## Data Download
Make sure to download the data used in this project from [10.6084/m9.figshare.27880434](https://figshare.com/ndownloader/files/50690154). Unzip this data and store it in the `data/` directory within the current project directory.


## Installation
```bash
git clone https://github.com/jyesselman2/dms_3d_features.git
cd dms_3d_features

# Create a new conda environment
conda create --name dms_quant_framework python=3.8

# Activate the conda environment
conda activate dms_quant_framework

# if you need to install RNAfold
conda install -c bioconda viennarna

# Install the package
pip install . 

# Deactivate the conda environment to reset
conda deactivate
conda activate dms_quant_framework

# Download the data from figshare
wget https://figshare.com/ndownloader/files/50690154 -O data.zip
unzip data.zip

# Run the tests
# all should pass
pytest 
```

## Running the analysis 

### Generate motif data
processes the DMS data generated by rna-map and breaks constructs up into motifs
```bash
python dms_3d_features/cli.py generate-motif-data
```

### Generate 3D features
NOTE you must have 3DNA installed (http://forum.x3dna.org/site-announcements/download-instructions/) to run this script. 

```bash
python dms_3d_features/cli.py generate-pdb-features
```
